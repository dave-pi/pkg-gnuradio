From a981e0bcd4c7a08f2e25785c5d036f0428417d23 Mon Sep 17 00:00:00 2001
From: Kevin Gentile <kg168212@ohio.edu>
Date: Fri, 14 Jul 2017 15:27:34 -0400
Subject: [PATCH 52/58] gr-blocks: add warning if file will not be fully
 consumed with the passed output type.

---
 gr-blocks/lib/file_source_impl.cc | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/gr-blocks/lib/file_source_impl.cc b/gr-blocks/lib/file_source_impl.cc
index 1602b02416..cc57a905ed 100644
--- a/gr-blocks/lib/file_source_impl.cc
+++ b/gr-blocks/lib/file_source_impl.cc
@@ -110,6 +110,16 @@ namespace gr {
 	throw std::runtime_error("can't open file");
       }
 
+      //Check to ensure the file will be consumed according to item size
+      fseek(d_new_fp, 0, SEEK_END);
+      int file_size = ftell(d_new_fp);
+      rewind (d_new_fp);
+
+      //Warn the user if part of the file will not be consumed.
+      if(file_size % d_itemsize){
+        GR_LOG_WARN(d_logger, "WARNING: File will not be fully consumed with the current output type");
+      }
+
       d_updated = true;
       d_repeat = repeat;
     }
-- 
2.11.0

