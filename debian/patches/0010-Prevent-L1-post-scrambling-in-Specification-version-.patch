From e7cb7213cd4d73f0f093f4dd62406d3de47c1fea Mon Sep 17 00:00:00 2001
From: Ron Economos <w6rz@comcast.net>
Date: Wed, 5 Apr 2017 22:44:38 -0700
Subject: [PATCH 10/58] Prevent L1-post scrambling in Specification version
 1.1.1 mode.

---
 gr-dtv/lib/dvbt2/dvbt2_framemapper_cc_impl.cc | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/gr-dtv/lib/dvbt2/dvbt2_framemapper_cc_impl.cc b/gr-dtv/lib/dvbt2/dvbt2_framemapper_cc_impl.cc
index 1755fc82ca..f4dc7cdf2b 100644
--- a/gr-dtv/lib/dvbt2/dvbt2_framemapper_cc_impl.cc
+++ b/gr-dtv/lib/dvbt2/dvbt2_framemapper_cc_impl.cc
@@ -903,7 +903,12 @@ namespace gr {
       l1_constellation = l1constellation;
       t2_frames = t2frames;
       t2_frame_num = 0;
-      l1_scrambled = l1scrambled;
+      if (version == VERSION_131) {
+        l1_scrambled = l1scrambled;
+      }
+      else {
+        l1_scrambled = FALSE;
+      }
       stream_items = cell_size * fecblocks;
       if (N_FC == 0) {
         set_output_multiple((N_P2 * C_P2) + (numdatasyms * C_DATA));
-- 
2.11.0

